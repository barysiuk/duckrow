# Test installing skills from a git source via clone URL override

# Create a project directory
mkdir myproject

# Create skill files and turn into a git repo
mkdir skill-source
cp skill-md skill-source/SKILL.md
cp prompt-md skill-source/prompt.md
setup-git-repo skill-source test-skills test-skill

# Set up config override to redirect test-owner/test-repo to local git repo
setup-config-override test-owner/test-repo skill-source

# Install from git source (redirected via override)
exec duckrow install test-owner/test-repo -d myproject
stdout 'Installed: test-skill'
stdout 'Path:'
! stderr .

# Verify canonical directory was created
exists myproject/.agents/skills/test-skill/SKILL.md
exists myproject/.agents/skills/test-skill/prompt.md

# Verify the SKILL.md was copied correctly
file-contains myproject/.agents/skills/test-skill/SKILL.md 'test-skill'

# Verify status shows the installed skill
exec duckrow status myproject
stdout 'test-skill'
stdout 'A skill for testing'

-- skill-md --
---
name: test-skill
description: A skill for testing
metadata:
  version: "1.0.0"
  author: tester
---
# Test Skill

This is a test skill.
-- prompt-md --
You are a test skill assistant.
